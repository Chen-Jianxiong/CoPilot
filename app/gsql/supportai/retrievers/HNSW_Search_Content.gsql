CREATE DISTRIBUTED QUERY HNSW_Search_Content(STRING v_type, STRING milvus_host, 
  UINT milvus_port, STRING collection_name, STRING vector_field_name, 
  STRING vertex_id_field_name, STRING metric_type="L2", INT top_k, STRING query_vector_as_string) { 
  SetAccum<VERTEX> @@start_set;
  MapAccum<STRING, STRING> @@final_retrieval;
  
  @@start_set += HNSW_Search_Sub(embedding, index_name, k);
  
  src = {@@start_set};

  res = SELECT s FROM src:s -(:e)- :tgt
        ACCUM
          IF (s.type == "DocumentChunk" OR s.type == "Document") AND tgt.type == "Content" THEN
            @@final_retrieval += (s.id -> tgt.text)
          END
        POST-ACCUM
          IF s.type == "Relationship" OR s.type == "Entity" OR s.type == "Concept" THEN
            @@final_retrieval += (s.id -> s.definition)
          END;
    
  PRINT @@final_retrieval;     
}